<!doctype html>
<html class="no-js" lang="">

<head>
    <title>E-MedCenter</title>
    <meta charset="UTF-8">
    <meta name="keywords" content="Book Gp, Caregiver, Doctor">
    <meta name="description" content="Book Gp and Caregiver in a easy way">
    <meta name="author" content="Group 50">
    <!--<meta http-equiv="refresh" content="30">-->

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/navBar.css' %}"/>
    <link rel="stylesheet" type="text/css" href="{% static 'css/index.css' %}"/>
    <link rel="stylesheet" type="text/css" href="{% static 'css/newFooter.css' %}"/>
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <style>
        .user-avatar {
            vertical-align: middle;
            width: 50px;
            height: 50px;
            border-radius: 50%;
        }

        .message {
            max-width: 50%;
            margin: 10px;
            padding: 15px;
            border-radius: 18px;
            opacity: 0;
            animation: fadeIn 0.5s forwards;
            font-family: "Apple Braille", sans-serif; /* 使用与其他部分相同的字体 */
            color: white;
            text-after-overflow: scroll;
        }

        @keyframes fadeIn {
            to {
                opacity: 1;
            }
        }

        /* Style for messages from the user */
        .You { /* 使用与按钮相同的颜色 */
            color: white;
            text-align: right;
            margin-left: auto;
            margin-right: 10px;
        }

        /* Style for messages from the bot */
        .Neuron {
            color: white;
            text-align: left;
            margin-left: 10px;
            margin-right: auto;
        }

        @keyframes blink {
            0% {
                opacity: 1;
            }
            50% {
                opacity: 0;
            }
            100% {
                opacity: 1;
            }
        }

        .cursor {
            animation: blink 1s infinite;
            display: inline-block;
            width: 1ch;
            background-color: red;  /* 更改此行 */
        }

    </style>
    {% comment %}
    <script src="../js/plugins.js"></script>
    {% endcomment %}
    <style>
        .user-avatar {
            width: 50px; /* Desired width for the avatar */
            height: 50px; /* Desired height for the avatar */
            object-fit: cover; /* Retains image aspect ratio and covers the set dimensions */
            border-radius: 50%; /* Makes the avatar circular */
        }
    </style>
    <script type="text/javascript">
        var csrftoken = "{{ csrf_token }}";
    </script>

</head>
<body>

<!-- navigation bar -->
<header>
    <a href="{% url 'HomePage' %}" class="logo">E-MedCenter</a>
    <div class="navbar">
        <ul>
            <li><a href="{% url 'HomePage' %}">Home</a>
            </li>
            <li><a href="#">Book</a>
                <ul>
                    <li><a href="{% url 'BookCaregiverPage' %}">Book Caregiver</a></li>
                    <li><a href="{% url 'BookGPPage' %}">Book GP</a>
                </ul>
            </li>
            <li><a href="{% url 'Donation' %}">Donation</a></li>
            {% comment %}
            <li><a href="{% url 'ServiceInformationPage' %}">About us</a></li>
            {% endcomment %}
            <li><a href="{% url 'AboutusPage' %}">About Us</a></li>
            {% if user.is_authenticated %}
            <!-- 如果用户已登录，显示头像和身份特定的链接 -->
            <li>
                <a href="{% url 'profile' %}">
                    <img src="{{ user.userprofile.avatar.url }}" alt="{{ user.username }}" class="user-avatar">
                </a>
            </li>

            {% else %}
            <!-- 如果用户未登录，显示'Login/Signup'链接 -->
            <li><a href="{% url 'Login' %}">Login/Sign up</a></li>
            {% endif %}
        </ul>
    </div>
</header>

<section class="background" id="background">
    <div class="content" data-aos="fade-right"
         data-aos-delay="300"
         data-aos-duration="1000">
        <h1>Intelligent diagnosis</h1>
        <p>Try our industry-leading AI questioning system before booking an appointment with a GP.</p>
        <button class="backgroundButton" onclick="hideContent()"><span>Try now</span></button>
        <!-- <button class="button"><span>Try</span></button>-->
    </div>
    <div class="content2">
        <div id="chat-box">
        </div>

        <div id="send-area">
            <input type="text" id="user-input" placeholder="Type a message...">
            <button id="chat-button" onclick="sendMessage()">Send</button>
        </div>
    </div>
</section>
<section class="caregiver" id="caregiver" data-aos="fade-up-left"
         data-aos-anchor-placement="center-bottom"
         data-aos-delay="50"
         data-aos-duration="1000">
    <div class="showingPicture">
        <img src="https://picsum.photos/200/300" class="backgroundPicture">
    </div>
    <div class="contentRight">
        <h1>Appointment with a Caregiver</h1>
        <p>Choose your beloved caregiver based on time, cost and distance.</p>
        <button class="backgroundButton" onclick="navigateToPage('{% url 'BookCaregiverPage' %}')">Book now</button>

    </div>
</section>
<section class="gp" id="gp" data-aos="fade-up-right"
         data-aos-anchor-placement="center-bottom"
         data-aos-delay="50"
         data-aos-duration="1000">
    <div class="showingPicture2">
        <img src="https://picsum.photos/seed/picsum/200/300" class="backgroundPicture2">
    </div>
    <div class="contentLeft">
        <h1>Appointment with a General Practitioner</h1>
        <p>Choose your beloved General Practitioner based on time, cost and distance.</p>
        {% comment %}
        <button class="backgroundButton"><span>Book now</span></button>
        {% endcomment %}
        <button class="backgroundButton" onclick="navigateToPage('{% url 'BookGPPage' %}')">Book now</button>

    </div>
</section>

<section>
    <div class="footer">
        <ul class="footer-links">
            <li><a href="#">Site Map</a></li>
            <li><a href="#">Privacy Policy</a></li>
            <li><a href="#">Terms of Use</a></li>
            <li><a href="#">Support</a></li>
        </ul>
    </div>
</section>


<script>
    window.addEventListener("scroll", () => {
        let header = document.querySelector("header");
        header.classList.toggle("sticky", window.scrollY > 0);
    })

    function navigateToPage(url) {
        window.location.href = url;
    }

</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/0.157.0/three.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/vanta/0.5.24/vanta.halo.min.js"></script>
<script>
    VANTA.HALO({
        el: "#background",
        mouseControls: true,
        touchControls: true,
        gyroControls: false,
        minHeight: 200.00,
        minWidth: 200.00,
        xOffset: 0.26,
        yOffset: -0.13
    })
</script>


<script>
    function hideContent() {
        var contentDiv = document.querySelector('.content');
        var contentDiv2 = document.querySelector('.content2');
        var backGround = document.querySelector('.background')
        contentDiv.style.opacity = '0';  /* 设置透明度为0以隐藏元素 */
        contentDiv2.style.opacity = '1';  /* 设置透明度为1以显示元素 */
        contentDiv.style.display = 'none';
        contentDiv2.style.width = '95%';
        contentDiv2.style.height = '85vh'
        backGround.style.alignItems = 'flex-end'
        backGround.style.justifyContent = 'center'
        contentDiv2.style.marginBottom = '3vh'
        contentDiv2.style.justifyContent = 'flex-start'
        contentDiv2.style.padding = '3vh'

    }
</script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    function typeMessage(message, element, cursor) {
        let index = 0;

        function typeChar() {
            cursor.before(message[index]);
            index++;
            if (index < message.length) {
                setTimeout(typeChar, 100);  // 您可以更改此值以加速或减慢打印速度
            } else {
                cursor.remove();  // 删除光标
            }
        }

        typeChar();
    }

    function appendMessage(who, message) {
        let messageDiv = $(`<div class="message ${who}"><strong>${who}:</strong> </div>`);
        let cursor = $('<span class="cursor"></span>');
        messageDiv.append(cursor);
        $('#chat-box').append(messageDiv);
        $('#chat-box').scrollTop($('#chat-box')[0].scrollHeight);
        typeMessage(message, messageDiv, cursor);
    }

    $.ajaxSetup({
        beforeSend: function (xhr, settings) {
            if (!this.crossDomain) {
                xhr.setRequestHeader("X-CSRFToken", csrftoken);
            }
        }
    });

    function sendMessage() {
        let user_message = $('#user-input').val();
        appendMessage('You', user_message);
        $('#user-input').val('');

        // 创建一个临时的 .Neuron 消息框，并在其中显示一个闪烁的光标
        let tempNeuronDiv = $('<div class="message Neuron"><strong>Neuron:</strong> </div>');
        let cursor = $('<span class="cursor"></span>');
        tempNeuronDiv.append(cursor);
        $('#chat-box').append(tempNeuronDiv);
        $('#chat-box').scrollTop($('#chat-box')[0].scrollHeight);

        // 发送Ajax请求
        $.post('/ask/', {user_message: user_message}, function(data) {
            cursor.remove();  // 删除光标
            tempNeuronDiv.remove();  // 删除临时消息框
            appendMessage('Neuron', data.bot_reply);  // 使用打字机效果显示Neuron的回复
        });
    }

</script>


<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script>
    AOS.init();
</script>


</body>

</html>