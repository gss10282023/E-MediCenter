<!DOCTYPE html>
<html lang="en">

<head>
    <title>E-MedCenter</title>
    <meta charset="UTF-8">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="Book Gp, GP, Doctor">
    <meta name="description" content="Book Gp and GP in a easy way">
    <meta name="author" content="Group 50">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/navBar.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'css/newMatching.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'css/newFooter.css' %}" />

    <script src="https://unpkg.com/ionicons@4.5.10-0/dist/ionicons.js"></script>
</head>

<body>

    <header>
        <a href="{% url 'HomePage' %}" class="logo">E-MedCenter</a>
        <div class="navbar">
            <ul>
              <li><a href="{% url 'HomePage' %}">Home</a>
                </li>
                <li><a href="#">Book</a>
                    <ul>
                        <li><a href="{% url 'BookCaregiverPage' %}">Book Caregiver</a></li>
                        <li><a href="{% url 'BookGPPage' %}">Book GP</a>
                    </ul>
                </li>
                <li><a href="{% url 'Donation' %}">Donation</a></li>
                {% comment %} <li><a href="{% url 'ServiceInformationPage' %}">About us</a></li> {% endcomment %}
                <li><a href="{% url 'AboutusPage' %}">About Us</a></li>
                {% if user.is_authenticated %}
                <!-- 如果用户已登录，显示头像和身份特定的链接 -->
                <li>
                    <a href="{% url 'profile' %}">
                        <img src="{{ user.userprofile.avatar.url }}" alt="{{ user.username }}" class="user-avatar" >
                    </a>
                </li>

                {% else %}
                <!-- 如果用户未登录，显示'Login/Signup'链接 -->
                <li><a href="{% url 'Login' %}">Login/Sign up</a></li>
                {% endif %}
            </ul>
        </div>
      </header>

    <div class="center-content d-flex flex-column align-items-center justify-content-center" style="min-height: calc(100vh - 56px);">
        <div class="text-center mb-4">
            <h2 style=" margin-bottom: 10%; font-size:50px;">Booking GP</h2>
        </div>        
        <section class="bookingpage d-flex justify-content-center">
            <div class="bookingpage-form bg-white p-4 rounded shadow" style="width: 60%;">
                <form class="row gy-3 gx-3" action="{% url 'BookGPPage' %}" method="post">
                    {% csrf_token %}
                    <div class="col-12">
                        <label for="myRange">Distance: <span id="distanceValue">5 KM</span></label>
                        <div class="slidecontainer">
                            <input type="range" min="1" max="10" value="5" class="slider" id="myRange" name="distance">
                        </div>
                    </div>
                
                    <script>
                        document.addEventListener("DOMContentLoaded", function() {
                            var slider = document.getElementById("myRange");
                            var output = document.getElementById("distanceValue");
                            
                            slider.oninput = function() {
                                output.innerHTML = this.value + ' KM';
                            }
                        });
                    </script>         
                    <div class="col-4">
                        <label for="StreetInput">Street</label>
                        <input type="text" class="form-control" id="StreetInput" name = "street" required>
                    </div>
                    <div class="col-4">
                        <label for="SuburbInput">Suburb</label>
                        <input type="text" class="form-control" id="SuburbInput" name = "suburb" required>
                    </div>
                    <div class="col-4">
                        <label for="StateSelect">State</label>
                        <select class="form-control" id="StateSelect" name="state" required>
                            <option value="NSW">New South Wales</option>
                            <option value="VIC">Victoria</option>
                            <option value="QLD">Queensland</option>
                            <option value="SA">South Australia</option>
                            <option value="WA">Western Australia</option>
                            <option value="TAS">Tasmania</option>
                            <option value="ACT">Australian Capital Territory</option>
                            <option value="NT">Northern Territory</option>
                        </select>
                    </div>                    
                    <div class="col-4">
                        <label for="PostcodeInput">Postcode</label>
                        <input type="text" pattern="\d{4}" maxlength="4" class="form-control" id="PostcodeInput" name="postcode" required>
                    </div>                    
                    <div class="col-4">
                        <label for="dateInput">Date</label>
                        <input type="date" class="form-control" id="dateInput" name = "date" required>
                    </div>
                    <div class="col-4">
                        <label for="CostInput">Cost</label>
                        <input type="number" class="form-control" id="CostInput" name="cost" required>
                    </div>
                    <div class="col-12 text-center">
                        <button type="submit" class="btn btn-danger">Matching</button>
                    </div>
                </form>
            </div>
        </section>
    </div>


<div class="footer">
    <ul class="footer-links">
        <li><a href="#">Site Map</a></li>
        <li><a href="#">Privacy Policy</a></li>
        <li><a href="#">Terms of Use</a></li>
        <li><a href="#">Support</a></li>
    </ul>
</div>

<script>
function googleMapsCallback() {
    var streetInput = document.getElementById('StreetInput');
    var suburbInput = document.getElementById('SuburbInput');
    var postcodeInput = document.getElementById('PostcodeInput');

    function handlePlaceSelection(inputElement, place) {
        var addressComponents = place.address_components;

        // Reset values to make sure any previous input is cleared
        streetInput.value = '';
        suburbInput.value = '';
        postcodeInput.value = '';

        // Extract street, city, and postal code
        for (var i = 0; i < addressComponents.length; i++) {
            var addressType = addressComponents[i].types[0];
            var val = addressComponents[i].long_name;
            switch(addressType) {
                case 'street_number':
                    streetInput.value = val;
                    break;
                case 'route':
                    if (streetInput.value) {
                        streetInput.value += ' ';
                    }
                    streetInput.value += val;
                    break;
                case 'locality':
                    suburbInput.value = val;
                    break;
                case 'postal_code':
                    postcodeInput.value = val;
                    break;
            }
        }
    }

    var options = {
        types: ['address'],
        componentRestrictions: {country: 'au'}
    };

    // Autocomplete for street
    var autocompleteStreet = new google.maps.places.Autocomplete(streetInput, options);
    autocompleteStreet.addListener('place_changed', function() {
        handlePlaceSelection(streetInput, autocompleteStreet.getPlace());
    });

    // Autocomplete for suburb
    var autocompleteSuburb = new google.maps.places.Autocomplete(suburbInput, options);
    autocompleteSuburb.addListener('place_changed', function() {
        handlePlaceSelection(suburbInput, autocompleteSuburb.getPlace());
    });

    // Autocomplete for postcode
    var autocompletePostcode = new google.maps.places.Autocomplete(postcodeInput, {types: ['(regions)'], componentRestrictions: {country: 'au'}});
    autocompletePostcode.addListener('place_changed', function() {
        handlePlaceSelection(postcodeInput, autocompletePostcode.getPlace());
    });
}

</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBlGBJ1MbtPawltq76TsrzHzrFPFi_uMig&libraries=places&callback=googleMapsCallback"></script>

<!-- 你的其他JavaScript代码，例如AOS初始化等... -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    window.addEventListener("scroll",()=>{
        let header=document.querySelector("header");
        header.classList.toggle("sticky",window.scrollY>0);
    })
</script>
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script>
    AOS.init();
</script>

</body>
</html>